---
title: "P8105_hw5_sy2825"
author: "Shuo Yan (sy2825)"
output: github_document
date: "2018-11-06"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Poblem 1

First, let's import data and create a tidy dataframe containing data from all participants.

```{r import_and_tidy_longitudinal_data}

file_names = list.files(path = "./data", pattern = ".*csv")

file_data = map(file_names, ~ read.csv(file.path("./data", .)))

longitudinal_data = tibble(name = str_replace(file_names, ".csv", "")) %>%
  mutate(file_data = file_data) %>%
  unnest() %>%
  janitor::clean_names() %>%
  gather(key = week, value = observations, week_1:week_8) %>%
  mutate(week = str_replace(week, "week_", "")) %>%
  separate(name, into = c("arm", "id"), sep = "_") %>%
  mutate(arm = str_replace(arm, "con", "control")) %>%
  mutate(arm = str_replace(arm, "exp", "experimental"))

# Now we have a tidied dataframe :

longitudinal_data
```

The following is the spaghetti plot showing observations on each subject over time :

```{r longitudinal_data_plot}

ggplot(longitudinal_data, aes(x = week, y = observations, group = id, color = id)) +
  geom_path() + 
  labs(title = "Observations on each subject over time",
       x = "Week",
       y = "Observations") + 
  viridis::scale_color_viridis(
    name = "Subject ID", 
    discrete = TRUE) +
  facet_grid(. ~ arm) +
  theme(plot.title = element_text(hjust = 0.5))
```

From the plot we can see that the observation values of experimental group are mostly higher than the observation values of control group. Also, the observation values of experimental group tend to increase over time.



